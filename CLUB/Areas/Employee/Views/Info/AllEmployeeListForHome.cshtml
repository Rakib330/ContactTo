@model EmployeeInfoViewModel
@{
    ViewData["Title"] = @Model.fLang.title;
}

@section Style{
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
        .btn-Load {
            float: right;
            height: 130px;
        }
        @@media screen and (max-width: 480px) {
            .btn-Load {
                float: none;
                height: unset;
            }
        }
    </style>
}

<div class="row clearfix">
    <div class="col-12">
        <div class="card mb-4">
            <!-- Card Header - Dropdown -->
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold text-primary">@Model.fLang.title</h6>
            </div>



            @*<p class="text-center">
            <a class="btn btn-primary active" id="collapseQubtn">
                Quick Search
            </a>
            <a class="btn btn-primary" id="collapseAdbtn" >
                Advance Search
            </a>
        </p>*@

            @*<div class="card card-body" id="collapseQu" style="display:none;">
                <div class="row justify-content-center">
                    <div class="col-md-4 col-sm-12">
                            <input type="text" class="form-control" id="QuickSearch" placeholder="Search" />
                    </div>
                    <div class="col-md-2 col-sm-12">
                        <button type="button" class="btn btn-info" id="QuickSearchbtn">Search</button>
                    </div>
                </div>
                </div>*@

                @*<div class="input-group" id="collapseQu" style="display:none;">
            <div class="form-outline">
                <input type="search" id="QuickSearch" class="form-control" />
                <label class="form-label" for="QuickSearch">Search</label>
            </div>
            <button type="button" id="QuickSearchbtn" class="btn btn-primary">
                <i class="fas fa-search"></i>
            </button>
        </div>*@





                @*<div class="card-body" id="collapseAd" style="display:none">
            <div class="container">
                <form>
                    <div class="row">
                        <div class="col-md-5 col-sm-12 card" style="padding: 15px 15px 10px 25px;">
                            <div class="form-group row">
                                <h6 class="m-0 font-weight-bold text-primary">Select Value For Query</h6>
                            </div>

                            <div class="form-group row">
                                <label for="key" class="col-sm-3 col-form-label">Key</label>
                                <div class="col-sm-9">
                                    <select class="form-control" id="key" value="" name="key">
                                        <option value="">Select</option>
                                        <option value="Gender">Gender</option>
                                        <option value="MaritalStatus">Marital Status</option>
                                        <option value="Religion">Religion</option>
                                        <option value="BloodGroup">Blood Group</option>
                                        <!--<option value="FreedomFighter">Freedom Fighter</option>-->
                                        <option value="MemberType">Member Type</option>
                                        <option value="Division">Division</option>
                                        <option value="District">District</option>
                                        <option value="Thana">Thana/Upazila</option>
                                        <option value="Degree">Degree</option>
                                        <option value="Group">Group/Subject</option>
                                        <option value="Institution">Board/University/Institution</option>
                                        <!--<option value="SpacialSkill">Spacial Skill</option>-->
                                    </select>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="value" class="col-sm-3 col-form-label">Value</label>
                                <div class="col-sm-9">
                                    <select class="form-control" id="value" value="" name="value"></select>
                                </div>
                            </div>

                            <div class="form-group row">
                                <div class="col-sm-12">
                                    <button type="button" onclick="AddFilter()" class="btn btn-success btn-sm" style="float:right;"><i class="fas fa-plus"></i></button>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6 col-sm-12 card" style="padding: 15px 15px 10px 25px;">
                            <div class="form-group row">
                                <h6 class="m-0 font-weight-bold text-primary">Date Range For Query</h6>
                            </div>

                            <div class="form-group row">
                                <label for="dateKey" class="col-sm-3 col-form-label">Key</label>
                                <div class="col-sm-9">
                                    <select class="form-control" id="dateKey" value="" name="dateKey">
                                        <option value="">Select</option>
                                        <option value="dateOfBirth">Date of Birth (Own)</option>
                                        <option value="dateOfBirthSpouse">Date of Birth (Spouse)</option>
                                        <option value="dateOfMarriage">Date of Marriage</option>
                                        <option value="dateOfBirthChild">Date of Birth (Child)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="fromDate" class="col-sm-3 col-form-label">Date From</label>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="fromDate" placeholder="yyyy-mm-dd" value="" name="fromDate" />
                                </div>
                                <label for="fromDate" class="col-sm-1 col-form-label text-center">To</label>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="toDate" value="" placeholder="yyyy-mm-dd" name="toDate" />
                                </div>
                            </div>

                            <div class="form-group row">
                                <div class="col-sm-12">
                                    <button type="button" onclick="AddRangeFilter()" class="btn btn-success btn-sm" style="float:right;"><i class="fas fa-plus"></i></button>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-1 col-sm-12 card" style="padding: 15px 15px 10px 25px;">
                            <div class="form-group row">
                                <div class="col-sm-12">
                                    <button type="button" onclick="LoadByFilterOnThisPage()" class="btn btn-success btn-sm btn-Load"><i class="fas fa-search"></i> Load</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12 card" style="padding: 15px 15px 10px 25px;">
                            <div class="form-group row" id="allFilterString"></div>
                        </div>
                    </div>

                </form>
            </div>
        </div>*@

                <!-- Card Body -->
                <div class="card-body">
                    <table class="table table-striped table-bordered table-responsive-lg table-responsive-sm" style="width:100%;" id="allEmployeeListTable">
                        <thead>
                            <tr>
                                <th>@Model.fLang.employeeID</th>
                                <th>@Model.fLang.name</th>
                                <th>@Model.fLang.gpfAcNo</th>
                                <th>@Model.fLang.mobileNumber</th>
                                <th>@Model.fLang.emailAddress</th>
                                <th width="100px">@Model.fLang.action</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
    </div>
</div>

@section Scripts{
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        var table;
        $(document).ready(function () {
            $("#collapseQu").show();
            $("#collapseQu").addClass("active");
            $("#collapseQubtn").click(function () {
                $("#collapseQu").show();
                $("#collapseAd").hide();

                $("#collapseQubtn").addClass("active");
                $("#collapseAdbtn").removeClass("active");
            });
            $("#collapseAdbtn").click(function () {
                $("#collapseQu").hide();
                $("#collapseAd").show();

                $("#collapseAdbtn").addClass("active");
                $("#collapseQubtn").removeClass("active");
            });




            //$('#QuickSearch').on('keyup click', function () {
            //    filterGlobal();
            //});
            $('#QuickSearchbtn').on('click', function () {
                filterGlobal();
            });

            



            $('#fromDate').flatpickr({ dateFormat: "Y-m-d" });
            $('#toDate').flatpickr({ dateFormat: "Y-m-d" });

            //$('#fromDate').datepicker({ uiLibrary: 'bootstrap4', format: 'yyyy-mm-dd' });
            //$('#toDate').datepicker({ uiLibrary: 'bootstrap4', format: 'yyyy-mm-dd' });

            $("#key").change(function () {
                $("#value option").remove();
                $("#value").append('<option value="">Select</option>');
                if ($('#key').val() == "Gender") {
                    $("#value").append('<option value="Male">Male</option><option value="Female">Female</option><option value="Other">Other</option>')
                } else if ($('#key').val() == "MaritalStatus") {
                    $("#value").append('<option value="Married">Married</option><option value="Unmarried">Unmarried</option><option value="Widow">Widow</option><option value="Separated">Separated</option>')
                } else if ($('#key').val() == "Religion") {
                    $("#value").append('@foreach(var data in Model.religions) { <option value="@data.Id">@data.name</option>}')
                } else if ($('#key').val() == "BloodGroup") {
                    $("#value").append('<option value="O+">O+</option><option value="O-">O-</option><option value="A+">A+</option><option value="A-">A-</option><option value="B+">B+</option><option value="B-">B-</option><option value="AB+">AB+</option><option value="AB-">AB-</option>')
                } else if ($('#key').val() == "FreedomFighter") {
                    $("#value").append('<option value="Yes">Yes</option><option value="No">No</option>')
                } else if ($('#key').val() == "MemberType") {
                    $("#value").append('@foreach(var data in Model.employeeTypes) { <option value="@data.Id">@data.empType</option>}')
                } else if ($('#key').val() == "Division") {
                    $("#value").append('@foreach(var data in Model.divisions) { <option value="@data.Id">@data.divisionName</option>}')
                } else if ($('#key').val() == "District") {
                    $("#value").append('@foreach(var data in Model.districts) { <option value="@data.Id">@data.districtName</option>}')
                } else if ($('#key').val() == "Thana") {
                    $("#value").append('@foreach(var data in Model.thanas) { <option value="@data.Id">@data.thanaName</option>}')
                } else if ($('#key').val() == "Degree") {
                    $("#value").append('@foreach(var data in Model.degrees) { <option value="@data.Id">@data.degreeName</option>}')
                } else if ($('#key').val() == "Group") {
                    $("#value").append('@foreach(var data in Model.subjects) { <option value="@data.Id">@data.subjectName</option>}')
                } else if ($('#key').val() == "Institution") {
                    $("#value").append('@foreach(var data in Model.organizations) { <option value="@data.Id">@data.organizationName</option>}')
                } else if ($('#key').val() == "SpacialSkill") {
                    $("#value").append('@foreach(var data in Model.spacialSkills) { <option value="@data.Id">@data.skilName</option>}')
                } 
            });

            table = $('#allEmployeeListTable').DataTable({
                ajax: {
                    url: "/global/api/allEmpList/all",
                    dataSrc: ""
                },
                scrollX: true,
                search:false,
                columns: [
                    { data: "employeeCode" },
                    { data: "nameEnglish" },
                    { data: "designation" },
                    { data: "mobileNumberOffice" },
                    { data: "emailAddress" },
                    { data: "action" }
                ],
                stateSave: true,
                dom: "<'row'<'col-sm-12 col-md-2'l><'col-sm-12 col-md-3'B><'col-sm-12 col-md-7'f>>" +
                    "<'row'<'col-sm-12't>>" + "<'row'<'col-sm-12 col-md-6'i><'col-sm-12 col-md-6'pr>>",
                buttons: [
                    {
                        extend: 'excelHtml5',
                        text: '<i class="fa fa-file-excel"></i> Excel',
                        titleAttr: 'Excel',
                        exportOptions: {
                            columns: [0, 1, 2, 3, 4]
                        },
                        title: 'Bangladesh Engineers Club Ltd.',
                        messageTop: 'List Of Members',
                        class: 'btn btn-info'
                    },
                    {
                        extend: 'print',
                        text: '<i class="fa fa-print"></i> Print',
                        titleAttr: 'Print',
                        title: 'Bangladesh Engineers Club Ltd.',
                        messageTop: 'List Of Members',
                        exportOptions: {
                            columns: [0, 1, 2, 3, 4]
                        },
                        customize: function (doc) {
                            $(doc.document.body).find('h1').css('font-size', '20pt');
                            $(doc.document.body).find('h1').css('font-family', "'Times New Roman', Times, serif");
                            $(doc.document.body).find('h1').css('text-align', 'center');
                        }
                    }
                ]
            });
        });


        function filterGlobal() {
            $('#allEmployeeListTable')
                .DataTable()
                .search($('#QuickSearch').val(),true,true)
                .draw();
        }



        var index = 1;
        function AddFilter() {
            var key = $('#key').val();
            var value = $('#value').val();
            if (key != '' && value != '') {
                $('#allFilterString').append(
                    '<span id="filter' + index + '" style="margin-right:15px;margin-bottom:5px;margin-left: 20px;"><div class="form-group row"><input type="text" readonly style="border-radius:5px 0px 0px 5px;height:30.5px;" class="form-control col-10 clsStrings" id="strings' + index + '" value="' + key + '=' + value + '" name="strings' + index + '"><button type="button" style="border-radius: 0px 5px 5px 0px;margin-left: -5px;" id="button' + index + '" onclick="ClearbyID(' + index + ')" class="btn btn-danger btn-sm col-2"><i class="fas fa-times-circle"></i></button></div></span>'
                )
                index = index + 1;
            }
            $('#key').val('');
            $('#value').val('');
        }

        function AddRangeFilter() {
            var key = $('#dateKey').val();
            var valueFrom = $('#fromDate').val();
            var valueTo = $('#toDate').val();
            if (key != '' && valueFrom != '' && valueTo != '') {
                $('#allFilterString').append(
                    '<span id="filter' + index + '" style="margin-right:15px;margin-bottom:5px;margin-left: 20px;"><div class="form-group row"><input type="text" readonly style="border-radius:5px 0px 0px 5px;height:30.5px;width:300px;" class="form-control col-10 clsStrings" id="strings' + index + '" value="' + key + '=' + valueFrom + '=' + valueTo + '" name="strings' + index + '"><button type="button" style="border-radius: 0px 5px 5px 0px;margin-left: -5px;" id="button' + index + '" onclick="ClearbyID(' + index + ')" class="btn btn-danger btn-sm col-2"><i class="fas fa-times-circle"></i></button></div></span>'
                )
                index = index + 1;
            }
            $('#dateKey').val('');
            $('#fromDate').val('');
            $('#toDate').val('');
        }

        function ClearbyID(indx) {
            $('#allFilterString #filter' + indx).remove();
        }

        function LoadByFilterOnThisPage() {
            var queryString = "";
            var $allStrings = $("#allFilterString").find(".clsStrings");
            $allStrings.each(function () {
                queryString += '|' + $(this).val();
            });

            if (queryString == "" || queryString == null) {
                alert("Nothing To Query Please Add Query Element");
                $('#allEmployeeListTable').DataTable().destroy();

                table = $('#allEmployeeListTable').DataTable({
                    ajax: {
                        url: "/global/api/allEmpList/all",
                        dataSrc: ""
                    },
                    scrollX: true,
                    columns: [
                        { data: "employeeCode" },
                        { data: "nameEnglish" },
                        { data: "designation" },
                        { data: "mobileNumberOffice" },
                        { data: "emailAddress" },
                        { data: "action" }
                    ],
                    stateSave: true,
                    dom: "<'row'<'col-sm-12 col-md-2'l><'col-sm-12 col-md-3'B><'col-sm-12 col-md-7'f>>" +
                        "<'row'<'col-sm-12't>>" + "<'row'<'col-sm-12 col-md-6'i><'col-sm-12 col-md-6'pr>>",
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            text: '<i class="fa fa-file-excel"></i> Excel',
                            titleAttr: 'Excel',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4]
                            },
                            title: 'Bangladesh Engineers Club Ltd.',
                            messageTop: 'List Of Members',
                            class: 'btn btn-info'
                        },
                        {
                            extend: 'print',
                            text: '<i class="fa fa-print"></i> Print',
                            titleAttr: 'Print',
                            title: 'Bangladesh Engineers Club Ltd.',
                            messageTop: 'List Of Members',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4]
                            },
                            customize: function (doc) {
                                $(doc.document.body).find('h1').css('font-size', '20pt');
                                $(doc.document.body).find('h1').css('font-family', "'Times New Roman', Times, serif");
                                $(doc.document.body).find('h1').css('text-align', 'center');
                            }
                        }
                    ]
                });
            }
            else {
                $('#allEmployeeListTable').DataTable().destroy();

                table = $('#allEmployeeListTable').DataTable({
                    ajax: {
                        url: "/global/api/getEmployeeInfoAsQueryAbleMore/" + queryString,
                        dataSrc: ""
                    },
                    scrollX: true,
                    columns: [
                        { data: "employeeCode" },
                        { data: "nameEnglish" },
                        { data: "designation" },
                        { data: "mobileNumberOffice" },
                        { data: "emailAddress" },
                        { data: "action" }
                    ],
                    stateSave: false,
                    dom: "<'row'<'col-sm-12 col-md-2'l><'col-sm-12 col-md-3'B><'col-sm-12 col-md-7'f>>" +
                        "<'row'<'col-sm-12't>>" + "<'row'<'col-sm-12 col-md-6'i><'col-sm-12 col-md-6'pr>>",
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            text: '<i class="fa fa-file-excel"></i> Excel',
                            titleAttr: 'Excel',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4]
                            },
                            title: 'Bangladesh Engineers Club Ltd.',
                            messageTop: 'List Of Members',
                            class: 'btn btn-info'
                        },
                        {
                            extend: 'print',
                            text: '<i class="fa fa-print"></i> Print',
                            titleAttr: 'Print',
                            title: 'Bangladesh Engineers Club Ltd.',
                            messageTop: 'List Of Members',
                            exportOptions: {
                                columns: [0, 1, 2, 3, 4]
                            },
                            customize: function (doc) {
                                $(doc.document.body).find('h1').css('font-size', '20pt');
                                $(doc.document.body).find('h1').css('font-family', "'Times New Roman', Times, serif");
                                $(doc.document.body).find('h1').css('text-align', 'center');
                            }
                        }
                    ]
                });
            }
        }


    </script>
}